<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>User Activity Monitor</title>

<style>
body {
    font-family: "Segoe UI", Arial;
    background: #f3f6fb;
    min-height: 100vh;
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
}
.container {
    background: #ffffff;
    width: 900px;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
}
h2 {
    text-align: center;
    color: #1f2937;
    margin-bottom: 20px;
}
.controls {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}
button {
    background: #1e40af;
    color: white;
    border: none;
    padding: 10px 14px;
    border-radius: 6px;
    cursor: pointer;
}
button.secondary {
    background: #374151;
}
button:hover {
    opacity: 0.9;
}
.log {
    border: 1px solid #d1d5db;
    border-radius: 6px;
    max-height: 300px;
    overflow-y: auto;
    font-size: 13px;
}
.log-item {
    padding: 8px 10px;
    border-bottom: 1px solid #e5e7eb;
}
.log-item:nth-child(even) {
    background: #f9fafb;
}
.warning {
    color: #b91c1c;
    font-weight: 600;
    margin-top: 10px;
}
.input-area {
    margin-bottom: 15px;
}
input {
    width: 100%;
    padding: 9px;
    border: 1px solid #d1d5db;
    border-radius: 6px;
}
.export {
    margin-top: 15px;
    white-space: pre-wrap;
    background: #f9fafb;
    padding: 12px;
    border-radius: 6px;
    border: 1px solid #d1d5db;
    display: none;
}
</style>

</head>
<body>

<div class="container">
<h2>User Activity Monitor</h2>

<div class="input-area">
<input placeholder="Click here, type, or change focus to generate activity">
</div>

<div class="controls">
<button onclick="resetLog()">Reset Log</button>
<button class="secondary" onclick="exportLog()">Export Log</button>
</div>

<div id="warning" class="warning"></div>

<div class="log" id="log"></div>

<div id="exportBox" class="export"></div>
</div>

<script>
let activities = []
let clickCount = 0
const CLICK_THRESHOLD = 10

function addActivity(type, detail, phase) {
    const entry = {
        type,
        detail,
        phase,
        time: new Date().toLocaleTimeString()
    }
    activities.push(entry)
    if (type === "Click") clickCount++
    checkSuspicious()
    renderLog()
}

function checkSuspicious() {
    warning.innerText = clickCount > CLICK_THRESHOLD ? "Warning: Excessive clicking detected" : ""
}

function renderLog() {
    log.innerHTML = ""
    activities.forEach((a, i) => {
        log.innerHTML += `
        <div class="log-item">
            ${i + 1}. [${a.time}] ${a.type} | ${a.detail} | ${a.phase}
        </div>`
    })
}

document.addEventListener("click", e => {
    addActivity("Click", e.target.tagName, "Bubbling")
})

document.addEventListener("click", e => {
    addActivity("Click", e.target.tagName, "Capturing")
}, true)

document.addEventListener("keydown", e => {
    addActivity("KeyPress", e.key, "Bubbling")
})

document.addEventListener("focusin", e => {
    addActivity("Focus", e.target.tagName, "Bubbling")
})

document.addEventListener("focusin", e => {
    addActivity("Focus", e.target.tagName, "Capturing")
}, true)

function resetLog() {
    activities = []
    clickCount = 0
    log.innerHTML = ""
    warning.innerText = ""
    exportBox.style.display = "none"
}

function exportLog() {
    let text = "User Activity Log\n\n"
    activities.forEach((a, i) => {
        text += `${i + 1}. Time: ${a.time}\n   Type: ${a.type}\n   Detail: ${a.detail}\n   Phase: ${a.phase}\n\n`
    })
    exportBox.innerText = text
    exportBox.style.display = "block"
}
</script>

</body>
</html>
